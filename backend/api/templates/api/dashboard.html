{% extends "api/base.html" %}

{% block title %}我的视频 | Déjà Vocab{% endblock %}

{% block extra_css %}
<style>
    /* Dashboard container */
    .dashboard-container {
        position: relative;
    }
    
    /* Page header */
    .page-header {
        margin-bottom: 2rem;
    }
    
    .page-title {
        font-size: 1.875rem;
        font-weight: 800;
        color: var(--gray-900);
        margin-bottom: 0.75rem;
        letter-spacing: -0.025em;
        line-height: 1.2;
    }
    
    .dark .page-title {
        color: white;
    }
    
    .page-description {
        font-size: 1rem;
        color: var(--gray-600);
        max-width: 600px;
    }
    
    .dark .page-description {
        color: var(--gray-400);
    }
    
    /* Filter section */
    .filter-section {
        background-color: white;
        border-radius: 1rem;
        padding: 1.5rem;
        margin-bottom: 2rem;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        border: 1px solid var(--gray-200);
    }
    
    .dark .filter-section {
        background-color: var(--gray-800);
        border-color: var(--gray-700);
    }
    
    .filter-row {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
        align-items: center;
    }
    
    .date-filter {
        position: relative;
        width: 250px;
        flex-shrink: 0;
    }
    
    .date-input {
        width: 100%;
        padding: 0.625rem 1rem;
        border: 1px solid var(--gray-300);
        border-radius: 0.5rem;
        font-size: 0.875rem;
        background-color: white;
        color: var(--gray-900);
        transition: all 0.2s ease;
        padding-right: 2.5rem;
    }
    
    .dark .date-input {
        background-color: var(--gray-700);
        border-color: var(--gray-600);
        color: white;
    }
    
    .date-input:focus {
        border-color: var(--primary-400);
        box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.25);
        outline: none;
    }
    
    .date-icon {
        position: absolute;
        top: 50%;
        right: 1rem;
        transform: translateY(-50%);
        color: var(--gray-500);
        pointer-events: none;
    }
    
    .dark .date-icon {
        color: var(--gray-400);
    }
    
    .filter-buttons {
        display: flex;
        gap: 0.5rem;
        margin-left: auto;
    }

    .btn-primary, .btn-secondary {
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 500;
        transition: all 0.2s ease;
    }

    .btn-primary:active, .btn-secondary:active {
        transform: translateY(1px);
    }
    
    /* Empty state */
    .empty-state {
        background-color: white;
        border-radius: 1rem;
        padding: 4rem 2rem;
        text-align: center;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        border: 1px solid var(--gray-200);
        margin-top: 2rem;
    }
    
    .dark .empty-state {
        background-color: var(--gray-800);
        border-color: var(--gray-700);
    }
    
    .empty-icon {
        font-size: 4rem;
        color: var(--primary-400);
        margin-bottom: 1.5rem;
        opacity: 0.8;
    }
    
    .empty-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--gray-900);
        margin-bottom: 1rem;
    }
    
    .dark .empty-title {
        color: white;
    }
    
    .empty-description {
        font-size: 1rem;
        color: var(--gray-600);
        max-width: 500px;
        margin: 0 auto 2rem;
        line-height: 1.6;
    }
    
    .dark .empty-description {
        color: var(--gray-400);
    }
    
    .empty-steps {
        max-width: 400px;
        margin: 2rem auto;
        text-align: left;
    }
    
    .empty-step {
        position: relative;
        padding-left: 2.5rem;
        margin-bottom: 1.25rem;
        color: var(--gray-700);
    }
    
    .dark .empty-step {
        color: var(--gray-300);
    }
    
    .empty-step::before {
        content: '';
        position: absolute;
        left: 0;
        top: 0.25rem;
        width: 1.5rem;
        height: 1.5rem;
        border-radius: 50%;
        background-color: var(--primary-100);
        color: var(--primary-600);
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 0.75rem;
    }
    
    .dark .empty-step::before {
        background-color: rgba(59, 130, 246, 0.2);
        color: var(--primary-400);
    }
    
    .empty-step:nth-child(1)::before {
        content: '1';
    }
    
    .empty-step:nth-child(2)::before {
        content: '2';
    }
    
    .empty-step:nth-child(3)::before {
        content: '3';
    }
    
    .empty-step:nth-child(4)::before {
        content: '4';
    }
    
    .empty-step:nth-child(5)::before {
        content: '5';
    }
    
    /* Video list */
    .video-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 1.5rem;
    }
    
    .video-card {
        background-color: white;
        border-radius: 1rem;
        overflow: hidden;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        border: 1px solid var(--gray-200);
        transition: all 0.3s ease;
        height: 100%;
        display: flex;
        flex-direction: column;
    }
    
    .dark .video-card {
        background-color: var(--gray-800);
        border-color: var(--gray-700);
    }
    
    .video-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }
    
    .video-thumbnail {
        position: relative;
        padding-top: 56.25%; /* 16:9 aspect ratio */
        overflow: hidden;
        background-color: var(--gray-900);
    }
    
    .thumbnail-img {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.5s ease;
    }
    
    .video-card:hover .thumbnail-img {
        transform: scale(1.05);
    }
    
    .video-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(to bottom, rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.5));
        opacity: 0;
        transition: opacity 0.3s ease;
    }
    
    .video-card:hover .video-overlay {
        opacity: 1;
    }
    
    .play-button {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0.9);
        width: 3.5rem;
        height: 3.5rem;
        background-color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--primary-600);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        opacity: 0;
        transition: all 0.3s ease;
    }
    
    .play-button i {
        font-size: 1.5rem;
        margin-left: 0.25rem;
    }
    
    .video-card:hover .play-button {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
    }
    
    .video-content {
        padding: 1.25rem;
        flex-grow: 1;
        display: flex;
        flex-direction: column;
    }
    
    .video-title {
        font-size: 1rem;
        font-weight: 600;
        color: var(--gray-900);
        margin-bottom: 0.75rem;
        line-height: 1.4;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
        height: 2.8rem;
    }
    
    .dark .video-title {
        color: white;
    }
    
    .video-meta {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
        margin-bottom: 1rem;
    }
    
    .video-meta-item {
        display: flex;
        align-items: center;
        font-size: 0.75rem;
        color: var(--gray-600);
    }
    
    .dark .video-meta-item {
        color: var(--gray-400);
    }
    
    .video-meta-item i {
        margin-right: 0.375rem;
        color: var(--primary-500);
        font-size: 0.875rem;
    }
    
    .dark .video-meta-item i {
        color: var(--primary-400);
    }
    
    .video-actions {
        margin-top: auto;
        display: flex;
        gap: 0.75rem;
    }
    
    .btn-video {
        flex: 1;
        padding: 0.5rem 0.75rem;
        font-size: 0.75rem;
        font-weight: 500;
        border-radius: 0.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
    }
    
    .btn-video i {
        margin-right: 0.375rem;
    }
    
    .btn-video-primary {
        background-color: var(--primary-50);
        color: var(--primary-600);
        border: none;
    }
    
    .btn-video-primary:hover {
        background-color: var(--primary-100);
        color: var(--primary-700);
    }
    
    .dark .btn-video-primary {
        background-color: rgba(59, 130, 246, 0.2);
        color: var(--primary-400);
    }
    
    .dark .btn-video-primary:hover {
        background-color: rgba(59, 130, 246, 0.3);
        color: var(--primary-300);
    }
    
    .btn-video-secondary {
        background-color: white;
        color: var(--gray-700);
        border: 1px solid var(--gray-300);
    }
    
    .btn-video-secondary:hover {
        background-color: var(--gray-50);
        color: var(--gray-900);
    }
    
    .dark .btn-video-secondary {
        background-color: var(--gray-800);
        color: var(--gray-300);
        border-color: var(--gray-700);
    }
    
    .dark .btn-video-secondary:hover {
        background-color: var(--gray-700);
        color: white;
    }
    
    .btn-video-danger {
        background-color: white;
        color: #EF4444;
        border: 1px solid rgba(239, 68, 68, 0.3);
    }
    
    .btn-video-danger:hover {
        background-color: rgba(239, 68, 68, 0.1);
        color: #DC2626;
    }
    
    .dark .btn-video-danger {
        background-color: var(--gray-800);
        color: #F87171;
        border-color: rgba(248, 113, 113, 0.3);
    }
    
    .dark .btn-video-danger:hover {
        background-color: rgba(248, 113, 113, 0.15);
        color: #FECACA;
    }
    
    /* Pagination */
    .pagination-container {
        display: flex;
        justify-content: center;
        margin-top: 3rem;
        margin-bottom: 1rem;
    }
    
    .pagination {
        display: flex;
        gap: 0.5rem;
    }
    
    .page-item {
        margin: 0;
    }
    
    .page-link {
        display: flex;
        align-items: center;
        justify-content: center;
        min-width: 2rem;
        height: 2rem;
        padding: 0.25rem 0.5rem;
        border-radius: 0.5rem;
        background-color: white;
        color: var(--gray-700);
        font-size: 0.875rem;
        border: 1px solid var(--gray-200);
        transition: all 0.2s ease;
    }
    
    .dark .page-link {
        background-color: var(--gray-800);
        color: var(--gray-300);
        border-color: var(--gray-700);
    }
    
    .page-link:hover {
        background-color: var(--gray-50);
        color: var(--gray-900);
        border-color: var(--gray-300);
    }
    
    .dark .page-link:hover {
        background-color: var(--gray-700);
        color: white;
        border-color: var(--gray-600);
    }
    
    .page-item.active .page-link {
        background-color: var(--primary-600);
        color: white;
        border-color: var(--primary-600);
    }
    
    .dark .page-item.active .page-link {
        background-color: var(--primary-600);
        border-color: var(--primary-600);
    }
    
    .page-item.disabled .page-link {
        opacity: 0.5;
        pointer-events: none;
    }
    
    /* Delete confirmation modal */
    .modal-content-custom {
        border-radius: 1rem;
        border: none;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        overflow: hidden;
    }
    
    .dark .modal-content-custom {
        background-color: var(--gray-800);
        color: white;
    }
    
    .modal-header-danger {
        background: linear-gradient(135deg, #EF4444, #DC2626);
        color: white;
        border-bottom: none;
        padding: 1.25rem 1.5rem;
    }
    
    .modal-title-custom {
        font-weight: 600;
        font-size: 1.125rem;
        display: flex;
        align-items: center;
    }
    
    .modal-title-icon {
        margin-right: 0.75rem;
        font-size: 1.25rem;
    }
    
    .modal-close-white {
        color: white;
        opacity: 0.8;
        transition: opacity 0.2s ease;
    }
    
    .modal-close-white:hover {
        color: white;
        opacity: 1;
    }
    
    .modal-body-custom {
        padding: 1.5rem;
    }
    
    .warning-alert {
        background-color: rgba(239, 68, 68, 0.1);
        border-left: 4px solid #EF4444;
        padding: 1rem;
        border-radius: 0.5rem;
        margin-bottom: 1.5rem;
    }
    
    .dark .warning-alert {
        background-color: rgba(239, 68, 68, 0.15);
    }
    
    .warning-title {
        color: var(--gray-900);
        font-weight: 500;
        margin-bottom: 0.5rem;
    }
    
    .dark .warning-title {
        color: white;
    }
    
    .warning-text {
        color: #EF4444;
        margin: 0;
        display: flex;
        align-items: center;
    }
    
    .warning-text i {
        margin-right: 0.5rem;
    }
    
    .modal-footer-custom {
        border-top: none;
        padding: 1rem 1.5rem 1.5rem;
        display: flex;
        gap: 1rem;
    }
    
    .btn-modal {
        flex: 1;
        padding: 0.75rem 1rem;
        font-size: 0.875rem;
        font-weight: 500;
        border-radius: 0.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
    }
    
    .btn-modal i {
        margin-right: 0.5rem;
    }
    
    .btn-modal-cancel {
        background-color: white;
        color: var(--gray-700);
        border: 1px solid var(--gray-300);
    }
    
    .btn-modal-cancel:hover {
        background-color: var(--gray-50);
        color: var(--gray-900);
    }
    
    .dark .btn-modal-cancel {
        background-color: var(--gray-700);
        color: var(--gray-300);
        border-color: var(--gray-600);
    }
    
    .dark .btn-modal-cancel:hover {
        background-color: var(--gray-600);
        color: white;
    }
    
    .btn-modal-danger {
        background-color: rgba(239, 68, 68, 0.1);
        color: #EF4444;
        border: 1px solid #EF4444;
    }
    
    .btn-modal-danger:hover {
        background-color: #EF4444;
        color: white;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(239, 68, 68, 0.25);
    }
    
    /* List view toggle */
    .view-toggle {
        display: flex;
        gap: 0.5rem;
        margin-right: 1rem;
    }
    
    @media (max-width: 768px) {
        .view-toggle {
            display: none;
        }
    }
    
    .view-toggle-btn {
        width: 2.5rem;
        height: 2.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 0.5rem;
        border: 1px solid var(--gray-300);
        background-color: white;
        color: var(--gray-500);
        transition: all 0.2s ease;
    }
    
    .dark .view-toggle-btn {
        background-color: var(--gray-800);
        border-color: var(--gray-700);
        color: var(--gray-400);
    }
    
    .view-toggle-btn:hover {
        background-color: var(--gray-100);
        color: var(--gray-700);
    }
    
    .dark .view-toggle-btn:hover {
        background-color: var(--gray-700);
        color: var(--gray-300);
    }
    
    .view-toggle-btn.active {
        background-color: var(--primary-50);
        color: var(--primary-600);
        border-color: var(--primary-300);
    }
    
    .dark .view-toggle-btn.active {
        background-color: rgba(59, 130, 246, 0.2);
        color: var(--primary-400);
        border-color: rgba(59, 130, 246, 0.4);
    }
    
    /* List view style */
    .video-list {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }
    
    .video-list-item {
        background-color: white;
        border-radius: 1rem;
        overflow: hidden;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        border: 1px solid var(--gray-200);
        transition: all 0.3s ease;
        display: flex;
    }
    
    .dark .video-list-item {
        background-color: var(--gray-800);
        border-color: var(--gray-700);
    }
    
    .video-list-item:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }
    
    .video-list-thumbnail {
        width: 180px;
        flex-shrink: 0;
        position: relative;
        overflow: hidden;
        background-color: var(--gray-900);
    }
    
    .video-list-content {
        padding: 1rem;
        flex-grow: 1;
        display: flex;
        flex-direction: column;
    }
    
    .video-list-title {
        font-size: 1.125rem;
        font-weight: 600;
        color: var(--gray-900);
        margin-bottom: 0.5rem;
        line-height: 1.4;
    }
    
    .dark .video-list-title {
        color: white;
    }
    
    .video-list-meta {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
        margin-bottom: 1rem;
    }
    
    .video-list-actions {
        margin-top: auto;
        display: flex;
        gap: 0.75rem;
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
        .filter-row {
            flex-direction: column;
            align-items: stretch;
        }
        
        .date-filter {
            width: 100%;
        }
        
        .filter-buttons {
            margin-left: 0;
            width: 100%;
            justify-content: space-between;
        }
        
        .video-list-item {
            flex-direction: column;
        }
        
        .video-list-thumbnail {
            width: 100%;
            padding-top: 56.25%;
        }
        
        .video-actions {
            flex-wrap: wrap;
        }
        
        .filter-row {
            gap: 0.75rem;
        }
        
        .date-filter {
            width: 100%;
            margin-bottom: 0.5rem;
        }
        
        .filter-buttons {
            margin-left: 0;
            width: 100%;
            justify-content: space-between;
            margin-top: 0.75rem;
        }
        
        .filter-buttons .btn {
            padding: 0.75rem 1rem;
            flex: 1;
            font-size: 0.9rem;
            min-height: 2.75rem;
            border-radius: 0.5rem;
        }
        
        .filter-buttons i {
            font-size: 1.1rem;
            margin-right: 0.375rem;
        }
    }
    
    @media (max-width: 640px) {
        .video-grid {
            grid-template-columns: 1fr;
        }
    }
    
    /* Category tag options */
    .subtitle-tabs {
        margin-bottom: 1.5rem;
    }
    
    .subtitle-tabs .nav-tabs {
        border-bottom: 1px solid var(--border-color);
        gap: 1rem;
    }
    
    .subtitle-tabs .nav-link {
        color: var(--text-color);
        border: none;
        border-bottom: 2px solid transparent;
        transition: all 0.25s ease;
        padding: 0.75rem 1rem;
        border-radius: 0.5rem 0.5rem 0 0;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }
    
    .subtitle-tabs .nav-link i {
        font-size: 1.1rem;
    }
    
    .subtitle-tabs .nav-link .badge {
        font-size: 0.7rem;
        padding: 0.35em 0.65em;
        border-radius: 20px;
    }
    
    .subtitle-tabs .nav-link.active {
        color: var(--primary-color);
        background-color: var(--card-bg);
        border-bottom-color: var(--primary-color);
    }
    
    .subtitle-tabs .nav-link:hover:not(.active) {
        color: var(--primary-color-hover);
        border-bottom-color: var(--primary-color-hover);
        background-color: var(--hover-bg);
    }
    
    .dark .subtitle-tabs .nav-tabs {
        border-bottom-color: var(--dark-border-color);
    }
    
    .dark .subtitle-tabs .nav-link {
        color: var(--dark-text-color);
    }
    
    .dark .subtitle-tabs .nav-link.active {
        color: var(--dark-primary-color);
        background-color: var(--dark-card-bg);
        border-bottom-color: var(--dark-primary-color);
    }
    
    .dark .subtitle-tabs .nav-link:hover:not(.active) {
        color: var(--dark-primary-color-hover);
        border-bottom-color: var(--dark-primary-color-hover);
        background-color: var(--dark-hover-bg);
    }
    
    /* No subtitles tag */
    .no-subtitles-badge {
        position: absolute;
        top: 0.75rem;
        left: 0.75rem;
        padding: 0.35rem 0.65rem;
        background-color: rgba(var(--bg-rgb), 0.85);
        color: var(--text-color);
        border-radius: 0.5rem;
        font-size: 0.75rem;
        backdrop-filter: blur(4px);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        z-index: 5;
        display: flex;
        align-items: center;
        gap: 0.3rem;
        font-weight: 500;
        border: 1px solid var(--border-color);
        transition: all 0.2s ease;
    }
    
    .dark .no-subtitles-badge {
        background-color: rgba(var(--dark-bg-rgb), 0.85);
        color: var(--dark-text-color);
        border-color: var(--dark-border-color);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.25);
    }
    
    /* Empty state prompt */
    .alert {
        border-radius: 0.75rem;
        padding: 1.25rem;
        margin-bottom: 1.5rem;
        border: 1px solid transparent;
        background-color: var(--card-bg);
        color: var(--text-color);
    }
    
    .alert-info {
        border-color: var(--info-color);
        background-color: var(--info-bg);
    }
    
    .alert-success {
        border-color: var(--success-color);
        background-color: var(--success-bg);
    }
    
    .dark .alert {
        background-color: var(--dark-card-bg);
        color: var(--dark-text-color);
    }
    
    .dark .alert-info {
        border-color: var(--dark-info-color);
        background-color: var(--dark-info-bg);
    }
    
    .dark .alert-success {
        border-color: var(--dark-success-color);
        background-color: var(--dark-success-bg);
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
        .filter-row {
            flex-direction: column;
            align-items: stretch;
        }
        
        .date-filter {
            width: 100%;
        }
        
        .filter-buttons {
            margin-left: 0;
            width: 100%;
            justify-content: space-between;
        }
        
        .video-list-item {
            flex-direction: column;
        }
        
        .video-list-thumbnail {
            width: 100%;
            padding-top: 56.25%;
        }
        
        .video-actions {
            flex-wrap: wrap;
        }
        
        .filter-row {
            gap: 0.75rem;
        }
        
        .date-filter {
            width: 100%;
            margin-bottom: 0.5rem;
        }
        
        .filter-buttons {
            margin-left: 0;
            width: 100%;
            justify-content: space-between;
            margin-top: 0.75rem;
        }
        
        .filter-buttons .btn {
            padding: 0.75rem 1rem;
            flex: 1;
            font-size: 0.9rem;
            min-height: 2.75rem;
            border-radius: 0.5rem;
        }
        
        .filter-buttons i {
            font-size: 1.1rem;
            margin-right: 0.375rem;
        }
    }
    
    /* CSS variables - matching system design */
    :root {
        /* Primary color */
        --primary-color: var(--primary-500);
        --primary-color-hover: var(--primary-600);
        --primary-color-light: var(--primary-100);
        
        /* Status color */
        --info-color: var(--primary-300);
        --info-bg: rgba(147, 197, 253, 0.15);
        --success-color: var(--accent-green);
        --success-bg: rgba(16, 185, 129, 0.15);
        
        /* Layout colors */
        --border-color: var(--gray-200);
        --card-bg: white;
        --text-color: var(--gray-800);
        --hover-bg: var(--gray-100);
        --bg-rgb: 255, 255, 255;
        
        /* Dark mode */
        --dark-primary-color: var(--primary-400);
        --dark-primary-color-hover: var(--primary-300);
        --dark-primary-color-light: var(--primary-800);
        
        --dark-info-color: var(--primary-500);
        --dark-info-bg: rgba(59, 130, 246, 0.15);
        --dark-success-color: var(--accent-green);
        --dark-success-bg: rgba(16, 185, 129, 0.15);
        
        --dark-border-color: var(--gray-700);
        --dark-card-bg: var(--gray-800);
        --dark-text-color: var(--gray-200);
        --dark-hover-bg: var(--gray-700);
        --dark-bg-rgb: 31, 41, 55;
    }
    
    /* Category tag options */
    .subtitle-tabs {
        margin-bottom: 1.5rem;
    }
    
    .subtitle-tabs .nav-tabs {
        border-bottom: 1px solid var(--border-color);
        gap: 1rem;
    }
    
    .subtitle-tabs .nav-link {
        color: var(--text-color);
        border: none;
        border-bottom: 2px solid transparent;
        transition: all 0.25s ease;
        padding: 0.75rem 1rem;
        border-radius: var(--border-radius) var(--border-radius) 0 0;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }
    
    .subtitle-tabs .nav-link i {
        font-size: 1.1rem;
    }
    
    .subtitle-tabs .nav-link .badge {
        font-size: 0.7rem;
        padding: 0.35em 0.65em;
        border-radius: 20px;
    }
    
    .subtitle-tabs .nav-link.active {
        color: var(--primary-color);
        background-color: var(--card-bg);
        border-bottom-color: var(--primary-color);
    }
    
    .subtitle-tabs .nav-link:hover:not(.active) {
        color: var(--primary-color-hover);
        border-bottom-color: var(--primary-color-hover);
        background-color: var(--hover-bg);
    }
    
    .dark .subtitle-tabs .nav-tabs {
        border-bottom-color: var(--dark-border-color);
    }
    
    .dark .subtitle-tabs .nav-link {
        color: var(--dark-text-color);
    }
    
    .dark .subtitle-tabs .nav-link.active {
        color: var(--dark-primary-color);
        background-color: var(--dark-card-bg);
        border-bottom-color: var(--dark-primary-color);
    }
    
    .dark .subtitle-tabs .nav-link:hover:not(.active) {
        color: var(--dark-primary-color-hover);
        border-bottom-color: var(--dark-primary-color-hover);
        background-color: var(--dark-hover-bg);
    }
    
    /* No subtitles badge */
    .no-subtitles-badge {
        position: absolute;
        top: 0.75rem;
        left: 0.75rem;
        padding: 0.35rem 0.65rem;
        background-color: rgba(var(--bg-rgb), 0.85);
        color: var(--text-color);
        border-radius: var(--border-radius-sm);
        font-size: 0.75rem;
        backdrop-filter: blur(4px);
        box-shadow: var(--shadow-sm);
        z-index: 5;
        display: flex;
        align-items: center;
        gap: 0.3rem;
        font-weight: 500;
        border: 1px solid var(--border-color);
        transition: all var(--transition-normal) ease;
    }
    
    .dark .no-subtitles-badge {
        background-color: rgba(var(--dark-bg-rgb), 0.85);
        color: var(--dark-text-color);
        border-color: var(--dark-border-color);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.25);
    }
    
    /* Empty state prompt */
    .alert {
        border-radius: var(--border-radius-lg);
        padding: 1.25rem;
        margin-bottom: 1.5rem;
        border: 1px solid transparent;
        background-color: var(--card-bg);
        color: var(--text-color);
        box-shadow: var(--shadow-sm);
    }
    
    .alert i {
        margin-right: 0.5rem;
    }
    
    .alert-info {
        border-color: var(--info-color);
        background-color: var(--info-bg);
    }
    
    .alert-success {
        border-color: var(--success-color);
        background-color: var(--success-bg);
    }
    
    .dark .alert {
        background-color: var(--dark-card-bg);
        color: var(--dark-text-color);
        box-shadow: none;
    }
    
    .dark .alert-info {
        border-color: var(--dark-info-color);
        background-color: var(--dark-info-bg);
    }
    
    .dark .alert-success {
        border-color: var(--dark-success-color);
        background-color: var(--dark-success-bg);
    }
</style>
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <!-- Page header -->
    <div class="page-header">
        <h1 class="page-title">我的视频</h1>
        <p class="page-description">浏览和管理你收集的视频及字幕内容</p>
    </div>
    
    {% if videos %}
    <!-- Filter section -->
    <div class="filter-section">
        <div class="filter-row">
            <div class="date-filter">
                <input type="date" id="date-filter" class="date-input" placeholder="选择日期筛选">
                <i class="bi bi-calendar3 date-icon"></i>
            </div>
            
            <div class="view-toggle">
                <button type="button" id="grid-view-btn" class="view-toggle-btn active" title="网格视图">
                    <i class="bi bi-grid-3x3-gap-fill"></i>
                </button>
                <button type="button" id="list-view-btn" class="view-toggle-btn" title="列表视图">
                    <i class="bi bi-list-ul"></i>
                </button>
            </div>
            
            <div class="filter-buttons">
                <button id="apply-filter" class="btn btn-primary btn-sm">
                    <i class="bi bi-funnel me-1"></i> 筛选
                </button>
                <button id="reset-filter" class="btn btn-secondary btn-sm">
                    <i class="bi bi-arrow-counterclockwise me-1"></i> 重置
                </button>
            </div>
        </div>
    </div>
    
    <!-- 分类标签选项卡 -->
    <div class="subtitle-tabs mb-4">
        <ul class="nav nav-tabs">
            <li class="nav-item">
                <a class="nav-link active" id="with-subtitles-tab" data-bs-toggle="tab" href="#with-subtitles">
                    <i class="bi bi-chat-quote"></i> 有字幕视频 <span class="badge bg-primary">{{ total_with_subtitles }}</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="without-subtitles-tab" data-bs-toggle="tab" href="#without-subtitles">
                    <i class="bi bi-chat-x"></i> 无字幕视频 <span class="badge bg-secondary">{{ total_without_subtitles }}</span>
                </a>
            </li>
        </ul>
    </div>
    
    <!-- Category video content -->
    <div class="tab-content">
        <!-- With subtitles video -->
        <div class="tab-pane fade show active" id="with-subtitles">
            {% if videos_with_subtitles %}
                <!-- With subtitles video - grid view -->
                <div id="video-grid-view-with" class="video-grid">
                    {% for video in videos_with_subtitles %}
                    <div class="video-card" data-date="{{ video.created_at|date:'Y-m-d' }}">
                        <div class="video-thumbnail">
                            <img 
                                src="https://img.youtube.com/vi/{{ video.youtube_id }}/mqdefault.jpg" 
                                alt="{{ video.title }}" 
                                class="thumbnail-img"
                                onerror="this.src='https://via.placeholder.com/480x360?text=无缩略图'"
                            >
                            <div class="video-overlay"></div>
                            <a href="{% url 'video_detail' video.id %}" class="play-button">
                                <i class="bi bi-play-fill"></i>
                            </a>
                        </div>
                        <div class="video-content">
                            <h3 class="video-title">{{ video.title }}</h3>
                            <div class="video-meta">
                                <div class="video-meta-item">
                                    <i class="bi bi-clock"></i> {{ video.created_at|date:"Y-m-d" }}
                                </div>
                                <div class="video-meta-item">
                                    <i class="bi bi-chat-quote"></i> {{ video.subtitle_count }} 个字幕
                                </div>
                            </div>
                            <div class="video-actions">
                                <a href="{% url 'video_detail' video.id %}" class="btn-video btn-video-primary">
                                    <i class="bi bi-file-earmark-text"></i> 详情
                                </a>
                                <a href="{{ video.url }}" target="_blank" class="btn-video btn-video-secondary">
                                    <i class="bi bi-youtube"></i> YouTube
                                </a>
                                <button type="button" class="btn-video btn-video-danger" data-bs-toggle="modal" data-bs-target="#deleteModal{{ video.id }}">
                                    <i class="bi bi-trash"></i> 删除
                                </button>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                
                <!-- With subtitles video - list view -->
                <div id="video-list-view-with" class="video-list" style="display: none;">
                    {% for video in videos_with_subtitles %}
                    <div class="video-list-item" data-date="{{ video.created_at|date:'Y-m-d' }}">
                        <div class="video-list-thumbnail">
                            <img 
                                src="https://img.youtube.com/vi/{{ video.youtube_id }}/mqdefault.jpg" 
                                alt="{{ video.title }}" 
                                class="thumbnail-img"
                                onerror="this.src='https://via.placeholder.com/480x360?text=无缩略图'"
                            >
                            <div class="video-overlay"></div>
                            <a href="{% url 'video_detail' video.id %}" class="play-button">
                                <i class="bi bi-play-fill"></i>
                            </a>
                        </div>
                        <div class="video-list-content">
                            <h3 class="video-list-title">{{ video.title }}</h3>
                            <div class="video-list-meta">
                                <div class="video-meta-item">
                                    <i class="bi bi-clock"></i> 添加于 {{ video.created_at|date:"Y-m-d H:i" }}
                                </div>
                                <div class="video-meta-item">
                                    <i class="bi bi-chat-quote"></i> {{ video.subtitle_count }} 个字幕
                                </div>
                            </div>
                            <div class="video-list-actions">
                                <a href="{% url 'video_detail' video.id %}" class="btn-video btn-video-primary">
                                    <i class="bi bi-file-earmark-text"></i> 查看详情
                                </a>
                                <a href="{{ video.url }}" target="_blank" class="btn-video btn-video-secondary">
                                    <i class="bi bi-youtube"></i> 在YouTube中观看
                                </a>
                                <button type="button" class="btn-video btn-video-danger" data-bs-toggle="modal" data-bs-target="#deleteModal{{ video.id }}">
                                    <i class="bi bi-trash"></i> 删除
                                </button>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="alert alert-info">
                    <i class="bi bi-info-circle me-2"></i> 您还没有任何带字幕的视频。请通过Chrome扩展程序收集视频和字幕。
                </div>
            {% endif %}
        </div>
        
        <!-- Without subtitles video -->
        <div class="tab-pane fade" id="without-subtitles">
            {% if videos_without_subtitles %}
                <!-- Without subtitles video - grid view -->
                <div id="video-grid-view-without" class="video-grid">
                    {% for video in videos_without_subtitles %}
                    <div class="video-card" data-date="{{ video.created_at|date:'Y-m-d' }}">
                        <div class="video-thumbnail">
                            <div class="no-subtitles-badge">
                                <i class="bi bi-chat-x"></i> 无字幕
                            </div>
                            <img 
                                src="https://img.youtube.com/vi/{{ video.youtube_id }}/mqdefault.jpg" 
                                alt="{{ video.title }}" 
                                class="thumbnail-img"
                                onerror="this.src='https://via.placeholder.com/480x360?text=无缩略图'"
                            >
                            <div class="video-overlay"></div>
                            <a href="{% url 'video_detail' video.id %}" class="play-button">
                                <i class="bi bi-play-fill"></i>
                            </a>
                        </div>
                        <div class="video-content">
                            <h3 class="video-title">{{ video.title }}</h3>
                            <div class="video-meta">
                                <div class="video-meta-item">
                                    <i class="bi bi-clock"></i> {{ video.created_at|date:"Y-m-d" }}
                                </div>
                                <div class="video-meta-item">
                                    <i class="bi bi-exclamation-triangle"></i> 无字幕
                                </div>
                            </div>
                            <div class="video-actions">
                                <a href="{% url 'video_detail' video.id %}" class="btn-video btn-video-primary">
                                    <i class="bi bi-file-earmark-text"></i> 详情
                                </a>
                                <a href="{{ video.url }}" target="_blank" class="btn-video btn-video-secondary">
                                    <i class="bi bi-youtube"></i> YouTube
                                </a>
                                <button type="button" class="btn-video btn-video-danger" data-bs-toggle="modal" data-bs-target="#deleteModal{{ video.id }}">
                                    <i class="bi bi-trash"></i> 删除
                                </button>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                
                <!-- Without subtitles video - list view -->
                <div id="video-list-view-without" class="video-list" style="display: none;">
                    {% for video in videos_without_subtitles %}
                    <div class="video-list-item" data-date="{{ video.created_at|date:'Y-m-d' }}">
                        <div class="video-list-thumbnail">
                            <div class="no-subtitles-badge">
                                <i class="bi bi-chat-x"></i> 无字幕
                            </div>
                            <img 
                                src="https://img.youtube.com/vi/{{ video.youtube_id }}/mqdefault.jpg" 
                                alt="{{ video.title }}" 
                                class="thumbnail-img"
                                onerror="this.src='https://via.placeholder.com/480x360?text=无缩略图'"
                            >
                            <div class="video-overlay"></div>
                            <a href="{% url 'video_detail' video.id %}" class="play-button">
                                <i class="bi bi-play-fill"></i>
                            </a>
                        </div>
                        <div class="video-list-content">
                            <h3 class="video-list-title">{{ video.title }}</h3>
                            <div class="video-list-meta">
                                <div class="video-meta-item">
                                    <i class="bi bi-clock"></i> 添加于 {{ video.created_at|date:"Y-m-d H:i" }}
                                </div>
                                <div class="video-meta-item">
                                    <i class="bi bi-exclamation-triangle"></i> 无字幕
                                </div>
                            </div>
                            <div class="video-list-actions">
                                <a href="{% url 'video_detail' video.id %}" class="btn-video btn-video-primary">
                                    <i class="bi bi-file-earmark-text"></i> 查看详情
                                </a>
                                <a href="{{ video.url }}" target="_blank" class="btn-video btn-video-secondary">
                                    <i class="bi bi-youtube"></i> 在YouTube中观看
                                </a>
                                <button type="button" class="btn-video btn-video-danger" data-bs-toggle="modal" data-bs-target="#deleteModal{{ video.id }}">
                                    <i class="bi bi-trash"></i> 删除
                                </button>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="alert alert-success">
                    <i class="bi bi-check-circle me-2"></i> 您的所有视频都有字幕！
                </div>
            {% endif %}
        </div>
    </div>

    <!-- Pagination -->
    {% if is_paginated %}
    <div class="pagination-container">
        <ul class="pagination">
            {% if page_obj.has_previous %}
            <li class="page-item">
                <a class="page-link" href="?page=1"><i class="bi bi-chevron-double-left"></i></a>
            </li>
            <li class="page-item">
                <a class="page-link" href="?page={{ page_obj.previous_page_number }}"><i class="bi bi-chevron-left"></i></a>
            </li>
            {% endif %}

            {% for num in page_obj.paginator.page_range %}
                {% if page_obj.number == num %}
                <li class="page-item active">
                    <span class="page-link">{{ num }}</span>
                </li>
                {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                <li class="page-item">
                    <a class="page-link" href="?page={{ num }}">{{ num }}</a>
                </li>
                {% endif %}
            {% endfor %}

            {% if page_obj.has_next %}
            <li class="page-item">
                <a class="page-link" href="?page={{ page_obj.next_page_number }}"><i class="bi bi-chevron-right"></i></a>
            </li>
            <li class="page-item">
                <a class="page-link" href="?page={{ page_obj.paginator.num_pages }}"><i class="bi bi-chevron-double-right"></i></a>
            </li>
            {% endif %}
        </ul>
    </div>
    {% endif %}
    
    {% else %}
    <!-- Empty state -->
    <div class="empty-state">
        <div class="empty-icon">
            <i class="bi bi-collection-play"></i>
        </div>
        <h2 class="empty-title">您还没有任何视频</h2>
        <p class="empty-description">使用Chrome插件Dejavocab收集YouTube视频字幕后，它们将显示在这里。开始您的语言学习之旅吧！</p>
        
        <div class="empty-steps">
            <div class="empty-step">
                安装Chrome插件Dejavocab
            </div>
            <div class="empty-step">
                使用与此相同的账号登录插件
            </div>
            <div class="empty-step">
                访问任意YouTube英文视频页面
            </div>
            <div class="empty-step">
                点击全屏播放右侧出现的新图标
            </div>
            <div class="empty-step">
                字幕将自动收集并存储在您的账号下
            </div>
        </div>
    </div>
    {% endif %}
    
    <!-- Delete confirmation modals -->
    {% for video in videos %}
    <div class="modal fade" id="deleteModal{{ video.id }}" tabindex="-1" aria-labelledby="deleteModalLabel{{ video.id }}" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content modal-content-custom">
                <div class="modal-header modal-header-danger">
                    <h5 class="modal-title modal-title-custom" id="deleteModalLabel{{ video.id }}">
                        <i class="bi bi-exclamation-triangle-fill modal-title-icon"></i>
                        确认删除视频
                    </h5>
                    <button type="button" class="btn-close modal-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body modal-body-custom">
                    <div class="warning-alert">
                        <p class="warning-title">您确定要删除视频"<strong>{{ video.title }}</strong>"及其所有字幕吗？</p>
                        <p class="warning-text"><i class="bi bi-exclamation-circle"></i> 此操作无法撤销。</p>
                    </div>
                    
                    <div class="video-preview" style="display: flex; align-items: center; margin-top: 1rem;">
                        <img 
                            src="https://img.youtube.com/vi/{{ video.youtube_id }}/mqdefault.jpg"
                            alt="{{ video.title }}"
                            style="width: 120px; border-radius: 0.5rem; margin-right: 1rem;"
                            onerror="this.src='https://via.placeholder.com/120x68?text=无缩略图'"
                        >
                        <div>
                            <div style="font-weight: 500; margin-bottom: 0.5rem;">{{ video.title }}</div>
                            <div style="font-size: 0.875rem; opacity: 0.7;"><i class="bi bi-chat-quote me-1"></i> {{ video.subtitle_count }} 个字幕</div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer modal-footer-custom">
                    <button type="button" class="btn-modal btn-modal-cancel" data-bs-dismiss="modal">
                        <i class="bi bi-x"></i> 取消
                    </button>
                    <form method="post" action="{% url 'delete_video' video.id %}" style="flex: 1;">
                        {% csrf_token %}
                        <button type="submit" class="btn-modal btn-modal-danger" id="confirmDelete{{ video.id }}">
                            <i class="bi bi-trash"></i> 确认删除
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Date filtering
        const dateFilter = document.getElementById('date-filter');
        const applyFilterBtn = document.getElementById('apply-filter');
        const resetFilterBtn = document.getElementById('reset-filter');
        const videoItems = document.querySelectorAll('.video-card, .video-list-item');
        
        // Handle date filter application
        applyFilterBtn.addEventListener('click', function() {
            const selectedDate = dateFilter.value;
            if (!selectedDate) {
                showToast('提示', '请先选择日期', 'warning');
                return;
            }
            
            let hasMatches = false;
            
            videoItems.forEach(item => {
                if (item.dataset.date === selectedDate) {
                    item.style.display = '';
                    hasMatches = true;
                } else {
                    item.style.display = 'none';
                }
            });
            
            if (!hasMatches) {
                showToast('提示', '没有找到匹配的视频', 'info');
            } else {
                showToast('成功', `找到 ${selectedDate} 的视频`, 'success');
            }
        });
        
        // Reset filter
        resetFilterBtn.addEventListener('click', function() {
            dateFilter.value = '';
            videoItems.forEach(item => {
                item.style.display = '';
            });
            showToast('提示', '筛选已重置', 'info');
        });
        
        // Toggle between grid and list view
        const gridViewBtn = document.getElementById('grid-view-btn');
        const listViewBtn = document.getElementById('list-view-btn');
        
        // New view elements
        const gridViewWith = document.getElementById('video-grid-view-with');
        const listViewWith = document.getElementById('video-list-view-with');
        const gridViewWithout = document.getElementById('video-grid-view-without');
        const listViewWithout = document.getElementById('video-list-view-without');
        
        // Switch to grid view - handle view switching for both tabs
        function switchToGridView() {
            // With subtitles tab
            if (gridViewWith) {
                gridViewWith.style.display = '';
                if (listViewWith) listViewWith.style.display = 'none';
            }
            
            // Without subtitles tab
            if (gridViewWithout) {
                gridViewWithout.style.display = '';
                if (listViewWithout) listViewWithout.style.display = 'none';
            }
            
            // Update button state
            gridViewBtn.classList.add('active');
            listViewBtn.classList.remove('active');
            
            // Store preference
            localStorage.setItem('videoViewPreference', 'grid');
        }
        
        function switchToListView() {
            // With subtitles tab
            if (gridViewWith) {
                gridViewWith.style.display = 'none';
                if (listViewWith) listViewWith.style.display = '';
            }
            
            // Without subtitles tab
            if (gridViewWithout) {
                gridViewWithout.style.display = 'none';
                if (listViewWithout) listViewWithout.style.display = '';
            }
            
            // Update button state
            gridViewBtn.classList.remove('active');
            listViewBtn.classList.add('active');
            
            // Store preference
            localStorage.setItem('videoViewPreference', 'list');
        }
        
        // Grid view button click event
        gridViewBtn.addEventListener('click', switchToGridView);
        
        // List view button click event
        listViewBtn.addEventListener('click', switchToListView);
        
        // Check if on mobile device
        const isMobile = window.matchMedia('(max-width: 768px)').matches;
        
        // Load view preference if exists
        const viewPreference = localStorage.getItem('videoViewPreference');
        if (viewPreference === 'list') {
            switchToListView();
        } else {
            // Default to grid on desktops, list on mobile
            if (isMobile) {
                switchToListView();
            } else {
                switchToGridView();
            }
        }
        
        // Delete confirmation dialog
        document.querySelectorAll('[data-bs-toggle="modal"]').forEach(function(button) {
            button.addEventListener('click', function() {
                const targetModal = document.querySelector(button.dataset.bsTarget);
                const modal = new bootstrap.Modal(targetModal);
                modal.show();
            });
        });
        
        // Toast notification function
        function showToast(title, message, type) {
            const toastContainer = document.getElementById('toast-container');
            if (!toastContainer) return;
            
            const toast = document.createElement('div');
            toast.className = `toast toast-${type} fade`;
            
            const types = {
                'success': 'bi-check-circle',
                'warning': 'bi-exclamation-triangle',
                'error': 'bi-x-circle',
                'info': 'bi-info-circle'
            };
            
            const icon = types[type] || types.info;
            
            toast.innerHTML = `
                <div class="toast-header">
                    <i class="bi ${icon} me-2"></i>
                    <strong class="me-auto">${title}</strong>
                    <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
                </div>
                <div class="toast-body">${message}</div>
            `;
            
            toastContainer.appendChild(toast);
            
            const bootstrapToast = new bootstrap.Toast(toast, {
                delay: 3000
            });
            
            bootstrapToast.show();
            
            // Auto remove toast after it's hidden
            toast.addEventListener('hidden.bs.toast', function() {
                toast.remove();
            });
        }
    });
</script>
{% endblock %}